{% extends '@Crm/Customer/base.html.twig' %}

{% block title %}{{ customer.name }}{% endblock %}

{% block related_nav %}
    {{ parent() }}
    <li>
        <a href="{{ path('customer_edit', { 'id': customer.id }) }}"
           title="{% trans %}Edit{% endtrans %}">
            <i class="fa fa-pencil"></i> {% trans %}Customer edit{% endtrans %}
        </a>
    </li>
    <li>
        <a href="{{ path('address_new', {customer: customer.id}) }}">
            <i class="fa fa-plus"></i>
            {% trans %}Address creation{% endtrans %}
        </a>
    </li>
    <li>
        <a href="{{ path('inquiry_new', {'id': customer.id}) }}">
            <i class="fa fa-plus"></i>
            {% trans %}Inquiry creation{% endtrans %}
        </a>
    </li>
    <li>
        <a href="{{ path('invoice_new', {'customer': customer.id}) }}">
            <i class="fa fa-plus"></i>
            {% trans %}Invoice creation{% endtrans %}
        </a>
    </li>
{% endblock %}

{% block breadcrumb %}
    {{ parent() }}
    <li class="active">
        {{ customer.name }}
    </li>
{% endblock %}

{% block body %}
    <h1>{{ customer.name }}</h1>

    <table class="table table-striped table-hover table-bordered">
        <tbody>
        <tr>
            <th>Id</th>
            <td>{{ customer.id }}</td>
        </tr>
        <tr>
            <th>{% trans %}Created at{% endtrans %}</th>
            <td>{{ customer.createdAt|date }}</td>
        </tr>
        <tr>
            <th>{% trans %}Updated at{% endtrans %}</th>
            <td>{{ customer.updatedAt|date }}</td>
        </tr>
        </tbody>
    </table>

    <div class="panel panel-info">
        <div class="panel-heading">
            <a class="pull-right"
               data-toggle="collapse"
               href="#customer-meta-content"
               aria-expanded="false" aria-controls="customer-meta-content">
                <i class="fa fa-chevron-circle-down"></i>
            </a>
            <h2 class="panel-title" id="customer-meta">Meta</h2>
        </div>

        <div class="collapsing" id="customer-meta-content">
            <table class="table table-bordered table-condensed table-striped">
                {% if customer.createdAt.timestamp %}
                    <tr>
                        <th>{% trans %}Created at{% endtrans %}</th>
                        <td>{{ customer.createdAt|date }}</td>
                    </tr>
                {% endif %}
                {% if customer.createdBy %}
                    <tr>
                        <th>{% trans %}Created by{% endtrans %}</th>
                        <td>{{ customer.createdBy.username }}</td>
                    </tr>
                {% endif %}
                {% if customer.updatedAt.timestamp %}
                    <tr>
                        <th>{% trans %}Updated at{% endtrans %}</th>
                        <td>{{ customer.updatedAt|date }}</td>
                    </tr>
                {% endif %}
                {% if customer.updatedBy %}
                    <tr>
                        <th>{% trans %}Updated by{% endtrans %}</th>
                        <td>{{ customer.updatedBy.username }}</td>
                    </tr>
                {% endif %}
            </table>
        </div>
    </div>

    <h2>
        <a href="{{ path('address_index', {customer: customer.id}) }}">
            {% trans %}Address list{% endtrans %}
        </a>
    </h2>

    {% include 'CrmBundle:Address:_list.html.twig' with {addresses: customer.addresses[0:cfg_recent_amount]} %}

    <h2>
        <a href="{{ path('inquiry_index', {customer: customer.id}) }}">
            {% trans %}Inquiry list{% endtrans %}
        </a>
    </h2>

    {% include 'AcquisitionBundle:Inquiry:_list.html.twig' with {inquiries: customer.inquiries[0:cfg_recent_amount]} %}

    <h2>
        <a href="{{ path('invoice_index', {customer: customer.id}) }}">
            {% trans %}Invoice list{% endtrans %}
        </a>
    </h2>

    {% include 'CrmpAccBundle:Invoice:_list.html.twig' with {invoices: customer.invoices[0:cfg_recent_amount]} %}
{% endblock %}
