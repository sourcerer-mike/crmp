{% extends '@Crm/Customer/base.html.twig' %}

{% block title %}{{ customer.name }}{% endblock %}

{% block breadcrumb %}
    {{ parent() }}
    <li class="active">
        {{ customer.name }}
    </li>
{% endblock %}

{% block body %}
    <h1>{{ customer.name }}</h1>

    <h2>{{ "crmp.entity.relatedInformations"|trans }}</h2>

    <div class="panel panel-info">
        {% set entity = customer %}

        <div class="panel-heading"
             data-toggle="collapse"
             data-target="#entity{{ entity.id }}"
             title="{{ "crmp.panel.collapse"|trans }}">
            <button class="btn btn-xs btn-info pull-right"
                    title="{{ "crmp.panel.collapse"|trans }}">
                <i class="fa fa-chevron-circle-down"></i>
            </button>
            {{ "crmp.entity.metaInformation"|trans }}
        </div>

        <div id="entity{{ entity.id }}" class="collapse">
            <table class="table table-striped table-hover">
                <tbody>
                {% if entity.createdAt %}
                    <tr>
                        <th>{% trans %}crmp.createdAt{% endtrans %}</th>
                        <td>{{ entity.createdAt|date }}</td>
                    </tr>
                {% endif %}
                <tr>
                    <th>{% trans %}crmp.updatedAt{% endtrans %}</th>
                    <td>{{ entity.updatedAt|date }}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">
                {{ "crmp.crm.address.list"|trans }}
            </h3>
        </div>

        {% include 'CrmBundle:Address:_list.html.twig' with {addresses: customer.addresses[0:cfg_recent_amount]} %}

        <div class="panel-footer">
            <a href="{{ path('address_index', {customer: customer.id}) }}" class="btn btn-default">
                <i class="fa fa-table"></i>
                {{ "crmp.entity.related.more"|trans }}
            </a>
            <a href="{{ path('address_new', {customer: customer.id}) }}" class="btn btn-default">
                <i class="fa fa-plus"></i>
                {{ "crmp.crm.address.create"|trans }}
            </a>
        </div>
    </div>

    {{ crmp_panels(container.get('crmp.panels.related_entities')) }}

    <h2>
        <a href="{{ path('inquiry_index', {customer: customer.id}) }}">
            {{ "crmp.acquisition.inquiry.plural"|trans }}
        </a>
    </h2>

    {#{% include 'AcquisitionBundle:Inquiry:_list.html.twig' with {inquiries: customer.inquiries[0:cfg_recent_amount]} %}#}

    <h2>
        <a href="{{ path('invoice_index', {customer: customer.id}) }}">
            {{ "crmp.accounting.invoice.plural"|trans }}
        </a>
    </h2>

    {% include 'CrmpAccBundle:Invoice:_list.html.twig' with {invoices: customer.invoices[0:cfg_recent_amount]} %}
{% endblock %}
