services:
  crmp.menu_builder:
    class: Crmp\CrmBundle\Menu\MenuBuilder
    arguments: ["@knp_menu.factory", "@service_container"]

  crmp.menu.main:
    class: Knp\Menu\MenuItem
    factory: ["@crmp.menu_builder", createMainMenu]
    arguments: ["@request_stack"]
    tags:
      - { name: knp_menu.menu, alias: main }

  crmp.menu.related:
    class: Knp\Menu\MenuItem
    factory: ["@crmp.menu_builder", createRelatedMenu]
    arguments: ["@request_stack"]
    tags:
      - { name: knp_menu.menu, alias: related }

  crmp_crm.address.related_panel:
    class: Crmp\CrmBundle\Twig\PanelGroup
    tags:
      - { name: 'crmp.panel_group', alias: 'address_related' }

  crmp_crm.command.update_docs:
    class: Crmp\CrmBundle\Command\UpdateDocsCommand
    tags:
      - { name: console.command }

  crmp_crm.config:
    class: Crmp\CrmBundle\CoreDomain\Config\ConfigRepository
    arguments: ['@crmp_crm.doctrine.config_repository']

  crmp_crm.customer.related_panel:
    class: Crmp\CrmBundle\Twig\PanelGroup
    tags:
      - { name: 'crmp.panel_group', alias: 'customer_related' }

  crmp_crm.customer.panel.address:
    class: Crmp\CrmBundle\Twig\AddressPanel
    tags:
      - { name: 'crmp.panel', target: 'customer_related' }

  crmp_crm.dashboard_panel:
    class: Crmp\CrmBundle\Twig\PanelGroup
    tags:
      - { name: 'crmp.panel_group', alias: 'dashboard' }

  crmp_crm.doctrine.address_repository:
    class: Doctrine\ORM\EntityRepository
    factory: ['@doctrine.orm.entity_manager', getRepository]
    arguments:
      - Crmp\CrmBundle\Entity\Address

  crmp_crm.doctrine.config_repository:
      class: Doctrine\ORM\EntityRepository
      factory: ['@doctrine.orm.entity_manager', getRepository]
      arguments:
        - Crmp\CrmBundle\Entity\Config

  crmp_crm.doctrine.customer_repository:
      class: Doctrine\ORM\EntityRepository
      factory: ['@doctrine.orm.entity_manager', getRepository]
      arguments:
        - Crmp\CrmBundle\Entity\Customer

  crmp_crm.menu:
    public: false
    class: Crmp\CrmBundle\Menu\MenuDecorator
    decorates: crmp.menu_builder
    arguments: ["@crmp_crm.menu.inner", "@service_container"]

  crmp_crm.twig.panels:
    class: Crmp\CrmBundle\Twig\PanelsRenderer
    tags:
      - {name: 'twig.extension' }

  crmp_crm.twig.price:
    class: Crmp\CrmBundle\Twig\PriceRenderer
    tags:
      - {name: 'twig.extension' }

  crmp_crm.twig.register_globals:
    class: Crmp\CrmBundle\Twig\RegisterGlobals
    arguments: ['@service_container']
    tags:
      - {name: 'twig.extension' }

